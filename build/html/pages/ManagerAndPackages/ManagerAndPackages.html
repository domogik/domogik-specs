

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Purpose &mdash; Domogik specifications 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Domogik specifications 0.1 documentation" href="../../index.html" />
    <link rel="next" title="Mise en place d’un bus 1wire" href="../Mise en place d&#39;un bus 1wire/Mise en place d&#39;un bus 1wire.html" />
    <link rel="prev" title="Manage the packages" href="../Manage_the_packages/Manage_the_packages.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../Mise en place d'un bus 1wire/Mise en place d'un bus 1wire.html" title="Mise en place d’un bus 1wire"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../Manage_the_packages/Manage_the_packages.html" title="Manage the packages"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Domogik specifications 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<div class="section" id="purpose">
<h1>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h1>
<p>This messages are used by REST for acting or requesting managers about packages. See ((REST_package|REST /package page)) for more detail.</p>
</div>
<div class="section" id="xpl-messages">
<h1>Xpl messages<a class="headerlink" href="#xpl-messages" title="Permalink to this headline">¶</a></h1>
<div class="section" id="list-installed-packages-on-an-host">
<h2>List installed packages on an host<a class="headerlink" href="#list-installed-packages-on-an-host" title="Permalink to this headline">¶</a></h2>
<p>Notice : the request (xpl-cmnd) for getting the list of installed packages list is used on rest startup only. Manager sends updates when starting and everytime an install or uninstall action has run.</p>
<p>Command :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-cmnd
{
...
}
domogik.package
{
command=installed-packages-list
host=&lt;host or *&gt;
}</pre>
</div>
<p>Response :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-trig
{
...
}
domogik.package
{
command=installed-packages-list
host=&lt;host&gt;
fullname0=&lt;package fullname : type-name&gt;
name0=&lt;package name&gt;
type0=&lt;package type : plugin,...&gt;
version0=&lt;package version&gt;
enabled0=&lt;yes/no&gt;
fullname1=...
name1=...
type1=...
version1=...
enabled1=...
...
}</pre>
</div>
<p>Notice : the uuid is needed because several request are done in the same time by the user interface (and so by rest).</p>
</div>
<div class="section" id="get-package-dependencies-for-a-package">
<h2>Get package dependencies for a package<a class="headerlink" href="#get-package-dependencies-for-a-package" title="Permalink to this headline">¶</a></h2>
<p>Command :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-cmnd
{
...
}
domogik.package
{
command=get-dependencies
host=&lt;host&gt;
type=&lt;plugin, external, ..&gt;
id=&lt;package id&gt;
}</pre>
</div>
<p>Response :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-trig
{
...
}
domogik.package
{
command=get-dependencies
host=&lt;host&gt;
type=&lt;plugin, external, ..&gt;
id=&lt;package id&gt;
[error=&lt;error message&gt;]
[dep0-id=&lt;dependency id&gt;]
[dep0-type=&lt;dependency type : python, plugin, other, ...&gt;]
[dep1-id=...]
[dep1-type=...]
...
}</pre>
</div>
</div>
<div class="section" id="check-package-dependencies">
<h2>Check package dependencies<a class="headerlink" href="#check-package-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Command :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-cmnd
{
...
}
domogik.package
{
command=check-dependencies
host=&lt;host&gt;
[dep0=&lt;dependency&gt;]
[dep1=...]
...
}</pre>
</div>
<p>&#8216;&#8217;Dependency has python dependency format. Example : pySerial &gt;= 2.4&#8217;&#8216;</p>
<p>Response :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-trig
{
...
}
domogik.package
{
command=check-dependencies
host=&lt;host&gt;
[error=&lt;error message&gt;]
[dep0=&lt;dependency&gt;]
[dep0-installed=&lt;yes|no&gt;]
[dep0-release=&lt;installed release&gt;]
[dep0-candidate=&lt;release to install&gt;]
[dep0-cmd-line=&lt;command line to install dependency : "sudo easy_install ...."&gt;]
[dep1=...]
[dep1-installed=...]
[dep1-release=...]
[dep1-candidate=...]
[dep1-cmd-line=...]
...
}</pre>
</div>
<p>When an error is detected for a dependency, message can be incomplete (current and following dependencies are not listed in xpl message). Here are possible following errors :
* Wrong version format for &#8216;&lt;dependency&gt;&#8217; : should be &#8216;foo (...)&#8217;
* No candidate to dependency &#8216;&lt;dependency name&gt;&#8217; installation found
* Irrational version for dependency &lt;dependency&gt;</p>
</div>
<div class="section" id="install-a-package">
<h2>Install a package<a class="headerlink" href="#install-a-package" title="Permalink to this headline">¶</a></h2>
<p>A package is installed as two parts :
* the main host (the one with RINOR) part.
* the target host part.
If you have only one computer with Domogik, the two parts will be installed on the same host.</p>
<p>On main host, files needed by RINOR are installed (for plugins : xml files for url2xpl and stats). On target host, files needed on the host are installed (for plugins : python part of the plugin is installed there).</p>
<p>For all package&#8217;s type you need to send the two xPL messages. For each message, concerned host&#8217;s manager will know if it needs to install files or not.</p>
<div class="section" id="xpl-part-target-host-part">
<h3>Xpl part (target host part)<a class="headerlink" href="#xpl-part-target-host-part" title="Permalink to this headline">¶</a></h3>
<p>This message should be sent first.</p>
<p>Command :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-cmnd
{
}
domogik.package
{
command=install
host=&lt;target host&gt;
source=&lt;where we got the packet from. Actually only "cache" is handled&gt;
type=&lt;package type&gt;
id=&lt;package id&gt;
release=&lt;release number&gt;
part=xpl
}</pre>
</div>
<p>Response :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-trig
{
}
domogik.package
{
command=install
host=&lt;target host&gt;
error=&lt;small error message&gt;
source=&lt;where we got the packet from. Actually only "cache" is handled&gt;
type=&lt;package type&gt;
id=&lt;package id&gt;
release=&lt;release number&gt;
}</pre>
</div>
<p>For a plugin, if it is already installed and in running state, you will obtain the following error message : &#8220;Plugin &#8216;&lt;plugin name&gt;&#8217; is running. Stop it before installing plugin.&#8221;</p>
</div>
<div class="section" id="rinor-part">
<h3>Rinor part<a class="headerlink" href="#rinor-part" title="Permalink to this headline">¶</a></h3>
<p>This message should be sent only __after__ the previous (xpl part) give back its xpl-trig.</p>
<p>Command :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-cmnd
{
}
domogik.package
{
command=install
host=&lt;target host&gt;
source=&lt;where we got the packet from. Actually only "cache" is handled&gt;
type=&lt;package type&gt;
id=&lt;package id&gt;
release=&lt;release number&gt;
part=rinor
}</pre>
</div>
<p>Response :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-trig
{
}
domogik.package
{
command=install
host=&lt;target host&gt;
error=&lt;small error message&gt;
source=&lt;where we got the packet from. Actually only "cache" is handled&gt;
type=&lt;package type&gt;
id=&lt;package id&gt;
release=&lt;release number&gt;
}</pre>
</div>
</div>
</div>
<div class="section" id="uninstall-a-package">
<h2>Uninstall a package<a class="headerlink" href="#uninstall-a-package" title="Permalink to this headline">¶</a></h2>
<p>A package is installed as two parts :
* the main host (the one with RINOR) part.
* the target host part.</p>
<p>When uninstalling, we actually (0.2.0) only delete the description xml file for type __plugin__ and __external__</p>
<p>Command :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-cmnd
{
}
domogik.package
{
command=uninstall
host=&lt;target host&gt;
type=&lt;package type&gt;
id=&lt;package id&gt;
}</pre>
</div>
<p>Response :
.. code-block:</p>
<div class="highlight-python"><pre>xpl-trig
{
}
domogik.package
{
command=uninstall
host=&lt;target host&gt;
error=&lt;small error message&gt;
type=&lt;package type&gt;
id=&lt;package id&gt;
}</pre>
</div>
<p>For a plugin, if it is already installed and in running state, you will obtain the following error message : &#8220;Plugin &#8216;&lt;plugin name&gt;&#8217; is running. Stop it before installing plugin.&#8221;</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Purpose</a></li>
<li><a class="reference internal" href="#xpl-messages">Xpl messages</a><ul>
<li><a class="reference internal" href="#list-installed-packages-on-an-host">List installed packages on an host</a></li>
<li><a class="reference internal" href="#get-package-dependencies-for-a-package">Get package dependencies for a package</a></li>
<li><a class="reference internal" href="#check-package-dependencies">Check package dependencies</a></li>
<li><a class="reference internal" href="#install-a-package">Install a package</a><ul>
<li><a class="reference internal" href="#xpl-part-target-host-part">Xpl part (target host part)</a></li>
<li><a class="reference internal" href="#rinor-part">Rinor part</a></li>
</ul>
</li>
<li><a class="reference internal" href="#uninstall-a-package">Uninstall a package</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../Manage_the_packages/Manage_the_packages.html"
                        title="previous chapter">Manage the packages</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../Mise en place d&#39;un bus 1wire/Mise en place d&#39;un bus 1wire.html"
                        title="next chapter">Mise en place d&#8217;un bus 1wire</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/pages/ManagerAndPackages/ManagerAndPackages.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../Mise en place d'un bus 1wire/Mise en place d'un bus 1wire.html" title="Mise en place d’un bus 1wire"
             >next</a> |</li>
        <li class="right" >
          <a href="../Manage_the_packages/Manage_the_packages.html" title="Manage the packages"
             >previous</a> |</li>
        <li><a href="../../index.html">Domogik specifications 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Domogik team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>