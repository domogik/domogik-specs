

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DomoWeb Widgets &mdash; Domogik specifications 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Domogik specifications 0.1 documentation" href="../../index.html" />
    <link rel="next" title="Contributions on release 0.1.0" href="../WhoIsWho/WhoIsWho.html" />
    <link rel="prev" title="Views of the web UI" href="../Web_ui_views/Web_ui_views.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../WhoIsWho/WhoIsWho.html" title="Contributions on release 0.1.0"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../Web_ui_views/Web_ui_views.html" title="Views of the web UI"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Domogik specifications 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="domoweb-widgets">
<h1>DomoWeb Widgets<a class="headerlink" href="#domoweb-widgets" title="Permalink to this headline">¶</a></h1>
<p>||__Created:__|20/03/2012
__Creator:__|Ferllings
__Reviewers:__|
__Status:__|{GAUGE(value=&gt;90, max=&gt;100, label=&gt;&#8217;&#8216;draft&#8217;&#8216;, perc=&gt;true, labelsize=&gt;50, height=&gt;20, color=&gt;green, bgcolor=&gt;#EEEEEE)}{GAUGE}
__Target:__|0.2.2 (domoweb)
__References:__|((Packages_info_json|info.json file))||</p>
<div class="section" id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Each widget id should respect a naming convention: &#8216;creator_size_shortDescription&#8217;.</li>
</ul>
<p>** creator: The creator name (letter/number only, no space or punctuation)
** size: the widget size with the following format: width&#8217;x&#8217;height
** short description (letter/number only, no space or punctuation)</p>
<p>^(ex. dmg_1x1_BasicBooleanActuator)^</p>
<p>The widget root folder name should be identical to the widget id.
^/usr/share/domoweb/widgets/&lt; id &gt;/...^</p>
<div class="section" id="info-json">
<h3>info.json<a class="headerlink" href="#info-json" title="Permalink to this headline">¶</a></h3>
<div class="highlight-json"><div class="highlight"><pre>
</pre></div>
</div>
<p>caption=&#8221;json description file&#8221;</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd><p class="first">json_version: 1,
identity: {</p>
<blockquote>
<div>type: &#8216;dmg_widget&#8217;,
id: &#8216;dmg_1x1_test&#8217;,
version: 0.1,
name: &#8216;Basic test widget&#8217;,
description: &#8216;Description for Basic test..&#8217;,
creator: &#8216;Domogik&#8217;,
creator_email: <a class="reference external" href="mailto:'xx&#37;&#52;&#48;xxx&#46;fr">'xx<span>&#64;</span>xxx<span>&#46;</span>fr</a>&#8216;,
...</div></blockquote>
<p>},
images: {</p>
<blockquote>
<div>icon: &#8216;icon.png&#8217;,
banner: &#8216;banner.png&#8217;,
scrennshot: &#8216;screenshot.png&#8217;,</div></blockquote>
<p>},
parameters: {</p>
<blockquote>
<div>height: 1,
width: 1,
display_border: true,</div></blockquote>
<p>},
features: [</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd>id: &#8216;mafeature&#8217;,
type: &#8216;sensor.boolean&#8217;,
filters: [&#8216;...&#8217;, &#8216;...&#8217;],</dd>
</dl>
<p>},
{...},</p>
</div></blockquote>
<p>],
configs: [</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd>id: &#8216;maconfig&#8217;,
type: &#8216;...&#8217;,
default: &#8216;0&#8217;,</dd>
</dl>
<p>},
{...},</p>
</div></blockquote>
<p class="last">],
css: [&#8216;style.css&#8217;, &#8216;...&#8217;],
js: [&#8216;main.js&#8217;, &#8216;...&#8217;],</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<ul class="simple">
<li>version : ((Packages_info_json|see info.json page))</li>
<li>type : the type id for the widget element is &#8216;dmg_widget&#8217;.</li>
<li>identity : ((Packages_info_json|see info.json page))</li>
<li>images : ((Packages_info_json|see info.json page))</li>
<li>parameters :</li>
</ul>
<p>** height, width: widget size format (1 to 4)
** display_border (default: true) : Whether or not a border should be displayed around the widget.
* features :
** id : string to identify the feature in the widget options
** label : string to describe the parameter
** type: type of selectable features
** filters (optional) : filter the list on one of the item list.
format : &lt;techno&gt;.&lt;device&gt;.&lt;feature&gt; (* can be used)
* configs :
** id : string to identify the config item in the widget options
** label : string to describe the parameter
** type : type of the config data
* css : list of css files included in the &#8216;css/&#8217; folder
* js : list javascript files included in the &#8216;js/&#8217; folder
!!!!config types with available options
<a class="reference external" href="http://wiki.domogik.org/Spec_field_types">http://wiki.domogik.org/Spec_field_types</a></p>
</div>
<div class="section" id="js-main-js">
<h3>js/main.js<a class="headerlink" href="#js-main-js" title="Permalink to this headline">¶</a></h3>
<p>This file contains the widget main initialization functions.
.. code-block:: json</p>
<dl class="docutils">
<dt>caption=&#8221;Base structure&#8221;</dt>
<dd><dl class="first docutils">
<dt>(function($) {</dt>
<dd><dl class="first docutils">
<dt>$.create_widget({</dt>
<dd><p class="first">_init: function() {
},</p>
<p>_statesHandler: function(states) {
},</p>
<p class="last">_eventHandler: function(timestamp, value) {
},</p>
</dd>
</dl>
<p class="last">});</p>
</dd>
</dl>
<p class="last">})(jQuery);</p>
</dd>
</dl>
<p>!!!!_init function
Used to initialize the widget
!!!!_statsHandler function
Callback function used when requesting stats.
!!!!_eventHandler function
Callback function used when receiving event.
css/style.css
<strong>**********</strong></p>
<p>The widget css stylesheet file.
* Each rule should start with the widget id as class name (ex. .dmg_1x1_minimalSensorNumber&#8217;)</p>
</div>
<div class="section" id="template-py">
<h3>template.py<a class="headerlink" href="#template-py" title="Permalink to this headline">¶</a></h3>
<p>The content of this file will be copied inside the widget &lt;div&gt; object:
For now only static HTML is allowed. Later we should be able to use django template tags.
.. code-block:: json</p>
<p>caption=&#8221;Template&#8221;</p>
<blockquote>
<div><blockquote>
<div>&lt;div id=&#8217;widget_instance_1&#8217; class=&#8217;widget dmg_1x1_minimalSensorNumber height_1 width_1 border&#8217;&gt;
... content of the template.py file ...
&lt;/div&gt;</div></blockquote>
<p>Internal processing and data</p>
</div></blockquote>
<hr class="docutils" />
<dl class="docutils">
<dt>{IMG(attId=&#8221;395&#8221;)}{IMG}</dt>
<dd>Django Start</dd>
</dl>
<hr class="docutils" />
<ul class="simple">
<li>The &#8216;widgets&#8217; folder is parsed</li>
<li>If the json version is supported:</li>
</ul>
<p>** The widget is registered in the &#8216;widget&#8217; table
** The css &amp;amp; js assets are registered in &#8216;widget_css&#8217; and &#8216;widget_js&#8217; tables</p>
<blockquote>
<div>Placement in page</div></blockquote>
<hr class="docutils" />
<ul class="simple">
<li>A new instance is created (widget_instance), with a &#8216;config&#8217; icon</li>
<li>When &#8216;config&#8217; is clicked, a panel is opened</li>
</ul>
<p>** Some default options are displayed :
<a href="#id1"><span class="problematic" id="id2">**</span></a>* name and subname (if null, nothing is displayed)
** The features and configs items (from the info.json file section) are displayed
* When the config panel is closed:
** The values are saved in widget_feature/widget_config tables
** The feature/page links are sent to RINOR via REST API, for compatibility with other UI</p>
<blockquote>
<div>Page load</div></blockquote>
<hr class="docutils" />
<p>For each widget instance (widget_instance)
* css &amp;amp; js include tags are generated (widget_css widget_js), (no duplication)
* widget options are generated for widget call (widget, widget_feature, widget_config)
^{id: ..., features:[], configs:[]}^
* widget call is generated
^$(&#8216;#widget_instance_1&#8217;).dmg_1x1_minimalSensorNumber(options);^
* widget template is inserted</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">DomoWeb Widgets</a><ul>
<li><a class="reference internal" href="#structure">Structure</a><ul>
<li><a class="reference internal" href="#info-json">info.json</a></li>
<li><a class="reference internal" href="#js-main-js">js/main.js</a></li>
<li><a class="reference internal" href="#template-py">template.py</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../Web_ui_views/Web_ui_views.html"
                        title="previous chapter">Views of the web UI</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../WhoIsWho/WhoIsWho.html"
                        title="next chapter">Contributions on release 0.1.0</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/pages/Web_ui_widgets/Web_ui_widgets.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../WhoIsWho/WhoIsWho.html" title="Contributions on release 0.1.0"
             >next</a> |</li>
        <li class="right" >
          <a href="../Web_ui_views/Web_ui_views.html" title="Views of the web UI"
             >previous</a> |</li>
        <li><a href="../../index.html">Domogik specifications 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Domogik team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>